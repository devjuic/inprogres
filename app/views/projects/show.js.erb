var myhtml = '<h3 id="project-title"> \
				        <%= @project.title%> \
				        (<span class="task-count-<%= @project.id %>"><%= @project.tasks.count %></span>) \
			        </h3> \
              <%= j render partial: "form2" %> \
              <div id="project_details"> \
                <% @project.tasks.each do |task|%> \
                    <div class="task-box input-group"> \
                      <p><%= task.title %></p> \
                      <span class="input-group-btn"> \
                        <button class="btn btn-default" type="button" > \
                          <i class="fa fa-caret-down"></i> \
                        </button> \
                      </span> \
                    </div> \
                    <% unless task.description.nil? %> \
                      <div class="get-hidden"> \
                        <p><%= task.description %></p> \
                      </div> \
                    <% end %> \
                <% end %> \
              </div>';

$('#project_details').html(myhtml);
$('.selected-project').removeClass('selected-project');
$('.selected-<%= @project.id %>').addClass('selected-project');

$('button').click(function() {
  if ($(this).parent().parent().next().hasClass('get-hidden')) {

    $(this).parent().parent().next().slideToggle('fast');

    if ($(this).find('i').hasClass('fa-caret-down')) {
      $(this).find('i').removeClass('fa-caret-down').addClass('fa-caret-up');
    } else if ($(this).find('i').hasClass('fa-caret-up')) {
      $(this).find('i').removeClass('fa-caret-up').addClass('fa-caret-down');
    } 
  }
 
});
